{"version":3,"file":"mega-flow.es.js","sources":["../src/components/Form/Field.js","../src/helpers/conditions.js","../src/components/Form/FormRows.js","../src/components/Form/Form.js","../src/theme/icons.js","../src/props.js","../src/index.js"],"sourcesContent":["import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useFormContext } from \"react-hook-form\";\nimport {\n  BorderedRadio,\n  Checkbox,\n  Datepicker,\n  FilePond,\n  FileUpload,\n  Input,\n  PriceField,\n  Radio,\n  ReactSelect,\n  Select,\n  Stepper,\n  TextArea,\n  ToggleSwitch,\n} from \"@licenserocks/kit\";\n\nconst mapFieldTypeToComponent = (fieldType) => {\n  switch (fieldType) {\n    case \"datepicker\":\n      return Datepicker;\n    case \"select\":\n      return Select;\n    case \"borderedRadio\":\n      return BorderedRadio;\n    case \"checkbox\":\n      return Checkbox;\n    case \"radio\":\n      return Radio;\n    case \"toggleSwitch\":\n      return ToggleSwitch;\n    case \"fileUpload\":\n      return FileUpload;\n    case \"filePond\":\n      return FilePond;\n    case \"price\":\n      return PriceField;\n    case \"reactSelect\":\n      return ReactSelect;\n    case \"stepper\":\n      return Stepper;\n    case \"textArea\":\n      return TextArea;\n    default:\n      return Input;\n  }\n};\n\nexport const FormField = ({\n  data,\n  field,\n  hasError,\n  isRecurring,\n  recurringIndex,\n  stepIndex,\n  fieldId,\n  rowId,\n  wizardData,\n}) => {\n  const { control, register } = useFormContext();\n  const { conditions, defaultValue, name, required, type, ...others } = field;\n  const Field = mapFieldTypeToComponent(type);\n  const fieldKey = `step-${stepIndex}-row-${rowId}-field-${fieldId}`;\n  const fieldName = isRecurring\n    ? `${data.name}[${recurringIndex}].${name}`\n    : name;\n\n  const prevValue =\n    isRecurring &&\n    wizardData[data.name] &&\n    wizardData[data.name][recurringIndex]\n      ? wizardData[data.name][recurringIndex][name]\n      : wizardData[name];\n\n  return (\n    <Field\n      control={control}\n      defaultValue={prevValue || defaultValue}\n      hasError={hasError}\n      isRequired={required}\n      key={fieldKey}\n      name={fieldName}\n      register={register({\n        required,\n      })}\n      type={type}\n      {...others}\n    />\n  );\n};\n\nFormField.propTypes = {\n  data: PropTypes.shape({\n    name: PropTypes.string,\n    recurring: PropTypes.bool,\n    rows: PropTypes.arrayOf(PropTypes.shape({})),\n  }).isRequired,\n  field: PropTypes.shape({\n    conditions: PropTypes.arrayOf(PropTypes.string),\n    defaultValue: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n    name: PropTypes.string,\n    required: PropTypes.string,\n    type: PropTypes.string,\n  }).isRequired,\n  fieldId: PropTypes.number.isRequired,\n  hasError: PropTypes.bool.isRequired,\n  isRecurring: PropTypes.bool.isRequired,\n  recurringIndex: PropTypes.number,\n  stepIndex: PropTypes.number.isRequired,\n  wizardData: PropTypes.shape({}).isRequired,\n  rowId: PropTypes.number.isRequired,\n};\n\nFormField.defaultProps = {\n  recurringIndex: null,\n};\n","const getConditionValues = (conditions, watch, wizardData) => {\n  const name = conditions.map((c) => {\n    if (c.includes(\":\")) {\n      const [n] = c.split(\":\");\n      return n;\n    }\n    return c;\n  });\n\n  return watch(name, wizardData);\n};\n\nexport const checkCondition = (conditions, watch, wizardData) => {\n  const hasConditions = conditions && conditions.length > 0;\n  if (hasConditions) {\n    const conditionValues = getConditionValues(conditions, watch, wizardData);\n\n    return conditions.some((c) => {\n      if (c.includes(\":\")) {\n        const [name, value, not] = c.split(\":\");\n        const isTrue =\n          conditionValues[name] === value ||\n          (Array.isArray(value) && conditionValues[name]?.includes(value)) ||\n          (value === \"true\" && Boolean(conditionValues[name]));\n\n        if (not) return !isTrue;\n        return isTrue;\n      }\n      return conditionValues[c]?.length > 0 || !!conditionValues[c];\n    });\n  }\n  return true;\n};\n","import React, { Fragment, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styled from \"styled-components\";\nimport { useFormContext } from \"react-hook-form\";\nimport {\n  Alert,\n  Divider,\n  FormRow,\n  Icon,\n  OutlineButton,\n  Tooltip,\n} from \"@licenserocks/kit\";\n\nimport { FormField } from \"./Field\";\nimport { checkCondition } from \"../../helpers\";\n\nconst StyledRow = styled(FormRow)`\n  && {\n    label {\n      :only-child {\n        display: none;\n      }\n    }\n  }\n`;\n\nconst Hint = styled.span`\n  background: #f0f0f4;\n  border-radius: 100%;\n  width: 20px;\n  height: 20px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  margin-left: 8px;\n  vertical-align: middle;\n\n  svg {\n    color: #8685a6;\n    font-size: 10px;\n  }\n`;\n\nexport const FormRows = ({\n  data,\n  index,\n  isRecurring,\n  rows,\n  stepIndex,\n  wizardData,\n}) => {\n  const { errors, watch } = useFormContext();\n  const [expanded, setExpanded] = useState(false);\n  const showExpandButton = rows?.some((row) => row.expandable);\n\n  return (\n    <>\n      {rows?.map((row, idx) => {\n        const rowKey = `step-${stepIndex}-row-${idx}`;\n        const rowErrors = [];\n        const rowConditions = checkCondition(row.conditions, watch, wizardData);\n        if (!rowConditions) return null;\n\n        const showRow = row.expandable ? expanded : true;\n        const label = [...(row.label || [])];\n        if (row.hint)\n          label.push(\n            <Tooltip content={row.hint} contentProps={{ fontStyle: \"normal\" }}>\n              <Hint>\n                <Icon icon=\"question\" />\n              </Hint>\n            </Tooltip>\n          );\n\n        return (\n          <Fragment key={rowKey}>\n            <StyledRow\n              errors={rowErrors}\n              label={label.length > 0 ? label : null}\n              labelAlign={row.labelAlign}\n              labelGutter={row.labelGutter}\n              mb={row?.marginBottom}\n              show={showRow}\n            >\n              {row.message && (\n                <Alert color={row.messageColor} content={row.message} mb={2} />\n              )}\n\n              {row.fields?.map((field, fieldId) => {\n                const error =\n                  isRecurring && errors[data.name] && errors[data.name][index]\n                    ? errors[data.name][index][field.name]?.message\n                    : errors[field.name]?.message;\n\n                if (error) rowErrors.push(error);\n\n                const showIfHasCondition = checkCondition(\n                  field.conditions,\n                  watch,\n                  wizardData\n                );\n                if (!showIfHasCondition) return null;\n\n                return (\n                  <FormField\n                    data={data}\n                    field={field}\n                    fieldId={fieldId}\n                    hasError={!!error}\n                    isRecurring={isRecurring}\n                    recurringIndex={index}\n                    rowId={idx}\n                    stepIndex={stepIndex}\n                    wizardData={wizardData}\n                  />\n                );\n              })}\n            </StyledRow>\n\n            {row?.divider && <Divider my={row?.dividerSize} />}\n          </Fragment>\n        );\n      })}\n\n      {showExpandButton && (\n        <OutlineButton\n          color=\"secondary\"\n          onClick={() => setExpanded((prev) => !prev)}\n          size=\"sm\"\n        >\n          {expanded ? \"Hide Optional Params\" : \"Show Optional Params\"}\n        </OutlineButton>\n      )}\n    </>\n  );\n};\n\nFormRows.propTypes = {\n  data: PropTypes.shape({\n    name: PropTypes.string,\n    recurring: PropTypes.bool,\n    rows: PropTypes.arrayOf(PropTypes.shape({})),\n  }).isRequired,\n  stepIndex: PropTypes.number.isRequired,\n  wizardData: PropTypes.shape({}).isRequired,\n  index: PropTypes.number.isRequired,\n  isRecurring: PropTypes.bool.isRequired,\n  rows: PropTypes.arrayOf(PropTypes.shape({})).isRequired,\n};\n\nFormRows.defaultProps = {};\n","import React, { useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styled from \"styled-components\";\nimport { useFieldArray } from \"react-hook-form\";\nimport { Icon, OutlineButton, TextButton } from \"@licenserocks/kit\";\n\nimport { FormRows } from \"./FormRows\";\n\nconst Wrapper = styled.div`\n  padding: ${({ theme }) => theme.spacing(2, 2, 2, 6)};\n  background-color: ${({ theme }) => theme.palette.gray.light};\n  border: 1px solid ${({ theme }) => theme.palette.gray.regular};\n  border-radius: 16px;\n  margin-bottom: 16px;\n`;\n\nconst ButtonsWrapper = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: 8px;\n`;\n\nconst Form = ({ data, stepIndex, wizardData }) => {\n  const isRecurring = data.recurring;\n\n  const { fields, append, remove } = useFieldArray({\n    name: isRecurring ? data?.name : \"\",\n  });\n\n  useEffect(() => {\n    if (isRecurring && fields.length === 0) {\n      append();\n    }\n  }, []);\n\n  const renderRows = (index) => (\n    <FormRows\n      data={data}\n      index={index}\n      isRecurring={isRecurring}\n      rows={data.rows}\n      stepIndex={stepIndex}\n      wizardData={wizardData}\n    />\n  );\n\n  const renderRecurring = () =>\n    fields.map((item, idx) => (\n      <Wrapper key={item.id}>\n        <ButtonsWrapper>\n          <OutlineButton\n            color=\"danger\"\n            disabled={fields.length === 1}\n            onClick={() => remove(idx)}\n            size=\"sm\"\n          >\n            <Icon icon=\"trash\" prefix=\"fa\" />\n          </OutlineButton>\n        </ButtonsWrapper>\n\n        {renderRows(idx)}\n      </Wrapper>\n    ));\n\n  return (\n    <>\n      {isRecurring ? renderRecurring() : renderRows()}\n      {isRecurring && (\n        <TextButton content=\"+ Add item\" onClick={append} size=\"sm\" />\n      )}\n    </>\n  );\n};\n\nForm.propTypes = {\n  data: PropTypes.shape({\n    name: PropTypes.string,\n    recurring: PropTypes.bool,\n    rows: PropTypes.arrayOf(PropTypes.shape({})),\n  }).isRequired,\n  stepIndex: PropTypes.number.isRequired,\n  wizardData: PropTypes.shape({}).isRequired,\n};\n\nForm.defaultProps = {};\n\nexport default Form;\n","import {\n  faDownload,\n  faHashtag,\n  faTrash,\n} from \"@fortawesome/free-solid-svg-icons\";\n\nexport const MegaFlowIcons = {\n  faDownload,\n  faHashtag,\n  faTrash,\n};\n","import PropTypes from \"prop-types\";\n\nexport const MegaFlowPropTypes = {\n  icons: PropTypes.arrayOf(PropTypes.shape()),\n  schema: PropTypes.oneOfType([PropTypes.string, PropTypes.object]).isRequired,\n  onFinish: PropTypes.func,\n  onStepSubmit: PropTypes.func,\n  theme: PropTypes.shape(),\n  watcher: PropTypes.func,\n  watchList: PropTypes.arrayOf(PropTypes.string),\n  wizardProps: PropTypes.shape(),\n  wrapperProps: PropTypes.shape(),\n};\n\nexport const MegaFlowDefaultProps = {\n  icons: [],\n  onFinish: () => {},\n  watchList: [],\n};\n","import React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { FormProvider, useForm } from \"react-hook-form\";\nimport {\n  AppContainer,\n  RocksKitIcons,\n  RocksKitTheme,\n  Wizard,\n} from \"@licenserocks/kit\";\n\nimport { Form } from \"./components\";\nimport { MegaFlowIcons } from \"./theme\";\nimport { MegaFlowPropTypes, MegaFlowDefaultProps } from \"./props\";\n\nconst Wrapper = styled.div``;\n\nconst MegaFlow = ({\n  defaultValues,\n  icons,\n  schema,\n  onFinish,\n  onStepSubmit,\n  theme,\n  watcher,\n  watchList,\n  wizardProps,\n  wrapperProps,\n  ...props\n}) => {\n  // Parse if schema was type of JSON string\n  const parsedSchema = typeof schema === \"string\" ? JSON.parse(schema) : schema;\n\n  const { steps } = parsedSchema;\n  const [currentStep, setCurrentStep] = useState(0);\n  const isCurrentLastStep = currentStep === steps.length - 1;\n  const [wizardData, setWizardData] = useState(defaultValues);\n\n  const { handleSubmit, ...methods } = useForm({\n    defaultValues: wizardData,\n  });\n\n  if (watcher && watchList.length > 0) {\n    watcher(methods.watch(watchList));\n  }\n\n  const onSubmit = (data) => {\n    const currentState = {\n      ...wizardData,\n      ...data,\n    };\n    // Set step data in global wizard object\n    setWizardData(currentState);\n\n    // Send step data to props\n    if (onStepSubmit) onStepSubmit(data);\n\n    if (!isCurrentLastStep) {\n      setCurrentStep((prev) => prev + 1);\n    } else {\n      onFinish(currentState);\n    }\n  };\n\n  const stepsArray = steps.map((st) => ({\n    title: st.title,\n  }));\n\n  const renderForm = () => (\n    <Form\n      data={steps[currentStep]}\n      stepIndex={currentStep}\n      wizardData={wizardData}\n    />\n  );\n\n  return (\n    <AppContainer\n      icons={{ ...RocksKitIcons, ...MegaFlowIcons, ...icons }}\n      theme={theme || RocksKitTheme}\n    >\n      <Wrapper {...wrapperProps}>\n        <FormProvider {...methods}>\n          <form onSubmit={handleSubmit(onSubmit)}>\n            <Wizard\n              currentStepContent={renderForm()}\n              currentStepIndex={currentStep}\n              setCurrentStepIndex={setCurrentStep}\n              steps={stepsArray}\n              {...wizardProps}\n              {...props}\n            />\n          </form>\n        </FormProvider>\n      </Wrapper>\n    </AppContainer>\n  );\n};\n\nMegaFlow.propTypes = MegaFlowPropTypes;\n\nMegaFlow.defaultProps = MegaFlowDefaultProps;\n\nexport default MegaFlow;\n"],"names":["mapFieldTypeToComponent","fieldType","Datepicker","Select","BorderedRadio","Checkbox","Radio","ToggleSwitch","FileUpload","FilePond","PriceField","ReactSelect","Stepper","TextArea","Input","FormField","data","field","hasError","isRecurring","recurringIndex","stepIndex","fieldId","rowId","wizardData","useFormContext","control","register","conditions","defaultValue","name","required","type","others","Field","fieldKey","fieldName","prevValue","propTypes","PropTypes","shape","string","recurring","bool","rows","arrayOf","isRequired","oneOfType","object","number","defaultProps","getConditionValues","watch","map","c","includes","split","n","checkCondition","hasConditions","length","conditionValues","some","value","not","isTrue","Array","isArray","Boolean","StyledRow","styled","FormRow","Hint","span","FormRows","index","errors","useState","expanded","setExpanded","showExpandButton","row","expandable","idx","rowKey","rowErrors","rowConditions","showRow","label","hint","push","fontStyle","labelAlign","labelGutter","marginBottom","message","messageColor","fields","error","showIfHasCondition","divider","dividerSize","prev","Wrapper","div","theme","spacing","palette","gray","light","regular","ButtonsWrapper","Form","useFieldArray","append","remove","useEffect","renderRows","renderRecurring","item","id","MegaFlowIcons","faDownload","faHashtag","faTrash","MegaFlowPropTypes","icons","schema","onFinish","func","onStepSubmit","watcher","watchList","wizardProps","wrapperProps","MegaFlowDefaultProps","MegaFlow","defaultValues","props","parsedSchema","JSON","parse","steps","currentStep","setCurrentStep","isCurrentLastStep","setWizardData","useForm","handleSubmit","methods","onSubmit","currentState","stepsArray","st","title","renderForm","RocksKitIcons","RocksKitTheme"],"mappings":"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"}